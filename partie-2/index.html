<!doctype html><html lang=fr-fr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>- Cours Angular 5ème année</title><meta name=description content="Cours complet Angular 20+ pour les étudiants de 5ème année"><script src=https://cdn.tailwindcss.com></script><link href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><style>.prose{max-width:none;margin:0 auto;width:100%}body{background-color:#2c2c2c;color:#f0f0f0;overflow-x:auto}.prose *{box-sizing:border-box}.prose>*{display:block;width:fit-content}.prose h1,.prose h2,.prose h3,.prose h4{color:#f0f0f0;font-weight:700;display:block;width:100%}.prose h1{font-size:2.25rem;margin-top:2rem;margin-bottom:1rem}.prose h2{font-size:1.875rem;margin-top:1.5rem;margin-bottom:.75rem}.prose h3{font-size:1.5rem;margin-top:1.25rem;margin-bottom:.5rem}.prose code{background-color:transparent;padding:.25rem .5rem;border-radius:.375rem;font-size:.875rem;font-weight:500;color:#000;border:none;display:inline}.prose pre{background-color:#fff;color:#000;padding:1.5rem;border-radius:.75rem;overflow-x:auto;margin:1.5rem 0;border:1px solid #e5e7eb;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);display:block;width:100%;box-sizing:border-box}.prose blockquote{border-left:4px solid #3b82f6;padding-left:1rem;margin:1rem 0;font-style:italic;color:#d1d5db}.prose table{width:100%;border-collapse:collapse;margin:1rem 0}.prose th,.prose td{border:1px solid #4a5568;padding:.5rem;text-align:left;color:#f0f0f0}.prose th{background-color:#374151;font-weight:600;color:#f0f0f0}.prose ul,.prose ol{padding-left:1.5rem;margin:1rem 0;display:block}.prose li{margin:.25rem 0;display:list-item}.prose img{max-width:100%;height:auto;border-radius:.5rem;margin:1rem 0;display:block}.prose .highlight{background-color:#f59e0b;color:#1f2937;padding:.125rem .25rem;border-radius:.25rem}.prose .warning{background-color:#7f1d1d;border:1px solid #dc2626;color:#fecaca;padding:1rem;border-radius:.5rem;margin:1rem 0}.prose .info{background-color:#1e3a8a;border:1px solid #3b82f6;color:#bfdbfe;padding:1rem;border-radius:.5rem;margin:1rem 0}.prose .success{background-color:#14532d;border:1px solid #22c55e;color:#bbf7d0;padding:1rem;border-radius:.5rem;margin:1rem 0}</style></head><body class=min-h-screen><nav class="bg-blue-600 text-white shadow-lg"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between h-16"><div class="flex items-center"><a href=https://gaiaetmarkus.github.io/hugo-angular-5eme/ class="flex items-center space-x-2"><i class="fab fa-angular text-2xl"></i>
<span class="text-xl font-bold">Cours Angular 5ème année</span></a></div><div class="flex items-center space-x-4"><a href=/hugo-angular-5eme/introduction/ class="hover:text-blue-200 transition-colors">Introduction
</a><a href=/hugo-angular-5eme/partie-1/ class="hover:text-blue-200 transition-colors">Partie 1
</a><a href=/hugo-angular-5eme/partie-2/ class="hover:text-blue-200 transition-colors">Partie 2
</a><a href=/hugo-angular-5eme/partie-3/ class="hover:text-blue-200 transition-colors">Partie 3
</a><a href=/hugo-angular-5eme/partie-4/ class="hover:text-blue-200 transition-colors">Partie 4
</a><a href=/hugo-angular-5eme/partie-5/ class="hover:text-blue-200 transition-colors">Partie 5</a></div></div></div></nav><main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><article class="prose prose-lg mx-auto text-gray-100"><h1></h1><time datetime=0001-01-01T00:00:00+00:00>January 1, 1</time><h1 id=partie-2--authentification-et-formulaires-réactifs>Partie 2 : Authentification et Formulaires Réactifs</h1><h2 id=-objectifs-de-la-partie-2>🎯 Objectifs de la Partie 2</h2><p>À la fin de cette partie, vous serez capable de :</p><ul><li>✅ Créer des formulaires réactifs avec validation</li><li>✅ Implémenter l&rsquo;authentification complète (login/register)</li><li>✅ Utiliser les Guards pour protéger les routes</li><li>✅ Maîtriser le lazy loading des modules</li><li>✅ Gérer les intercepteurs HTTP</li><li>✅ Créer une interface admin fonctionnelle</li></ul><hr><h2 id=-étape-21--formulaires-réactifs>🔐 Étape 2.1 : Formulaires Réactifs</h2><h3 id=-étape-21--formulaires-réactifs---terminée><strong>✅ Étape 2.1 : Formulaires Réactifs - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ Composant Login avec ReactiveFormsModule</li><li>✅ Composant Register avec validation avancée</li><li>✅ Validateur personnalisé passwordMatchValidator</li><li>✅ Gestion des erreurs en temps réel</li><li>✅ Navigation entre Login et Register</li></ul><hr><h2 id=-étape-22--guards-de-protection>🛡️ Étape 2.2 : Guards de Protection</h2><h3 id=-étape-22--guards-de-protection---terminée><strong>✅ Étape 2.2 : Guards de Protection - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ AuthGuard pour protéger les routes authentifiées</li><li>✅ AdminGuard pour protéger les routes admin</li><li>✅ Redirection automatique vers login si non authentifié</li><li>✅ Gestion du returnUrl pour la redirection post-login</li></ul><hr><h2 id=-étape-23--lazy-loading-avancé>🔄 Étape 2.3 : Lazy Loading Avancé</h2><h3 id=-étape-23--lazy-loading-avancé---terminée><strong>✅ Étape 2.3 : Lazy Loading Avancé - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ Lazy loading déjà configuré dans les routes</li><li>✅ Composant Register avec validation avancée</li><li>✅ Navigation croisée entre Login et Register</li><li>✅ Chargement à la demande des modules</li></ul><hr><h2 id=-étape-24--interface-admin>👑 Étape 2.4 : Interface Admin</h2><h3 id=-étape-24--interface-admin---terminée><strong>✅ Étape 2.4 : Interface Admin - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ Tableau de bord avec statistiques en temps réel</li><li>✅ Gestion avancée des utilisateurs (changement de rôle)</li><li>✅ Gestion avancée des tickets (statut, priorité, attribution)</li><li>✅ Interface avec onglets (utilisateurs/tickets)</li><li>✅ Protection contre auto-suppression et auto-changement de rôle</li></ul><hr><h2 id=-étape-25--intercepteurs-http>🌐 Étape 2.5 : Intercepteurs HTTP</h2><h3 id=-étape-25--intercepteurs-http---terminée><strong>✅ Étape 2.5 : Intercepteurs HTTP - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ Intercepteur d&rsquo;authentification (ajout automatique des tokens)</li><li>✅ Intercepteur de loading (gestion des requêtes actives)</li><li>✅ Service ErrorService pour la gestion centralisée des erreurs</li><li>✅ Composant NotificationsComponent pour les toast notifications</li><li>✅ Gestion automatique des erreurs 401/403/500</li><li>✅ Notifications avec auto-suppression et design responsive</li></ul><p><strong>Fonctionnalités :</strong></p><ul><li>🔐 <strong>Authentification automatique</strong> : Ajout du token JWT aux headers</li><li>⏱️ <strong>Loading states</strong> : Compteur de requêtes actives</li><li>🔔 <strong>Notifications toast</strong> : Error, warning, info avec design adaptatif</li><li>🛡️ <strong>Gestion d&rsquo;erreurs</strong> : Centralisée avec ErrorService</li><li>📊 <strong>Logging</strong> : Traçage des requêtes avec durée</li></ul><hr><h2 id=-étape-26--validation-avancée>🎯 Étape 2.6 : Validation Avancée</h2><h3 id=-étape-26--validation-avancée---terminée><strong>✅ Étape 2.6 : Validation Avancée - TERMINÉE</strong></h3><p><strong>Implémentation :</strong></p><ul><li>✅ Validateur personnalisé passwordMatchValidator</li><li>✅ Validation en temps réel avec messages d&rsquo;erreur</li><li>✅ Gestion des erreurs de validation dans les formulaires</li><li>✅ Validation croisée (mot de passe et confirmation)</li><li>✅ Messages d&rsquo;erreur contextuels et informatifs</li></ul><hr><h3 id=pourquoi-les-formulaires-réactifs-><strong>Pourquoi les Formulaires Réactifs ?</strong></h3><p>Les formulaires réactifs d&rsquo;Angular offrent plusieurs avantages par rapport aux formulaires template-driven :</p><h4 id=-réactivité-et-performance><strong>🔄 Réactivité et Performance</strong></h4><ul><li><strong>Signals intégrés</strong> : Les formulaires réactifs utilisent les Signals d&rsquo;Angular 20+ pour une réactivité optimale</li><li><strong>Détection de changements efficace</strong> : Seuls les champs modifiés déclenchent des mises à jour</li><li><strong>Moins de cycles de détection</strong> : Performance améliorée pour les formulaires complexes</li></ul><h4 id=-testabilité><strong>🧪 Testabilité</strong></h4><ul><li><strong>Logique métier séparée</strong> : La logique du formulaire est dans le composant, pas dans le template</li><li><strong>Tests unitaires facilités</strong> : Possibilité de tester la logique sans DOM</li><li><strong>Validation centralisée</strong> : Plus facile à tester et maintenir</li></ul><h4 id=-contrôle-granulaire><strong>🎛️ Contrôle granulaire</strong></h4><ul><li><strong>Validation en temps réel</strong> : Validation dynamique selon l&rsquo;état des autres champs</li><li><strong>Transformations de données</strong> : Possibilité de transformer les valeurs avant affichage</li><li><strong>Gestion d&rsquo;état avancée</strong> : Contrôle précis de l&rsquo;état du formulaire</li></ul><h3 id=installation-des-modules-requis><strong>Installation des modules requis</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Les modules sont déjà inclus dans Angular 20+ par défaut</span>
</span></span><span class=line><span class=cl><span class=c1># ReactiveFormsModule est disponible dans @angular/forms</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=création-du-composant-de-login><strong>Création du composant de login</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Créer le composant de login</span>
</span></span><span class=line><span class=cl>ng generate component features/auth/components/login
</span></span></code></pre></td></tr></table></div></div><h3 id=création-du-service-authservice><strong>Création du service AuthService</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Créer le service d&#39;authentification</span>
</span></span><span class=line><span class=cl>ng generate service features/auth/services/auth
</span></span></code></pre></td></tr></table></div></div><h3 id=mise-à-jour-des-modèles-utilisateur><strong>Mise à jour des modèles utilisateur</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/features/auth/models/user.model.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>interface</span> <span class=nx>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span>: <span class=kt>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>email</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span> <span class=o>|</span> <span class=s1>&#39;admin&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>interface</span> <span class=nx>LoginRequest</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>email</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>password</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>interface</span> <span class=nx>RegisterRequest</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>email</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>password</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>confirmPassword</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=implémentation-du-service-authservice><strong>Implémentation du service AuthService</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/features/auth/services/auth.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Injectable</span><span class=p>,</span> <span class=nx>signal</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Observable</span><span class=p>,</span> <span class=k>of</span><span class=p>,</span> <span class=nx>throwError</span><span class=p>,</span> <span class=nx>delay</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;rxjs&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>User</span><span class=p>,</span> <span class=nx>LoginRequest</span><span class=p>,</span> <span class=nx>RegisterRequest</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../models/user.model&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Injectable</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>providedIn</span><span class=o>:</span> <span class=s1>&#39;root&#39;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>AuthService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>currentUser</span> <span class=o>=</span> <span class=nx>signal</span><span class=p>&lt;</span><span class=nt>User</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>public</span> <span class=nx>currentUser$</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>.</span><span class=nx>asReadonly</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Mock data - utilisateurs de test
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>private</span> <span class=nx>users</span>: <span class=kt>User</span><span class=p>[]</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span>: <span class=kt>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Admin User&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;admin@example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;admin&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span>: <span class=kt>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Normal User&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;user@example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Mock data - mots de passe (en réalité, ils seraient hashés)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>private</span> <span class=nx>passwords</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>key</span>: <span class=kt>string</span><span class=p>]</span><span class=o>:</span> <span class=kt>string</span> <span class=p>}</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;admin@example.com&#39;</span><span class=o>:</span> <span class=s1>&#39;admin123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user@example.com&#39;</span><span class=o>:</span> <span class=s1>&#39;user123&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Vérifier s&#39;il y a un utilisateur en session
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>savedUser</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;currentUser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>savedUser</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>savedUser</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>login</span><span class=p>(</span><span class=nx>credentials</span>: <span class=kt>LoginRequest</span><span class=p>)</span><span class=o>:</span> <span class=nx>Observable</span><span class=p>&lt;</span><span class=nt>User</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>u</span> <span class=o>=&gt;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>email</span> <span class=o>===</span> <span class=nx>credentials</span><span class=p>.</span><span class=nx>email</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>password</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>passwords</span><span class=p>[</span><span class=nx>credentials</span><span class=p>.</span><span class=nx>email</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>user</span> <span class=o>&amp;&amp;</span> <span class=nx>password</span> <span class=o>===</span> <span class=nx>credentials</span><span class=p>.</span><span class=nx>password</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Simuler un délai réseau
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>return</span> <span class=k>of</span><span class=p>(</span><span class=nx>user</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>500</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>throwError</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Email ou mot de passe incorrect&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>register</span><span class=p>(</span><span class=nx>userData</span>: <span class=kt>RegisterRequest</span><span class=p>)</span><span class=o>:</span> <span class=nx>Observable</span><span class=p>&lt;</span><span class=nt>User</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Vérifier si l&#39;email existe déjà
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>existingUser</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>u</span> <span class=o>=&gt;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>email</span> <span class=o>===</span> <span class=nx>userData</span><span class=p>.</span><span class=nx>email</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>existingUser</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>throwError</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Cet email est déjà utilisé&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Créer un nouvel utilisateur
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>newUser</span>: <span class=kt>User</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span>: <span class=kt>this.users.length</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span>: <span class=kt>userData.name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>email</span>: <span class=kt>userData.email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Ajouter aux mock data
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>newUser</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>passwords</span><span class=p>[</span><span class=nx>userData</span><span class=p>.</span><span class=nx>email</span><span class=p>]</span> <span class=o>=</span> <span class=nx>userData</span><span class=p>.</span><span class=nx>password</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Simuler un délai réseau
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=k>of</span><span class=p>(</span><span class=nx>newUser</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>500</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>logout</span><span class=p>()</span><span class=o>:</span> <span class=k>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>localStorage</span><span class=p>.</span><span class=nx>removeItem</span><span class=p>(</span><span class=s1>&#39;currentUser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>getCurrentUser</span><span class=p>()</span><span class=o>:</span> <span class=nx>User</span> <span class=o>|</span> <span class=kc>null</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>getAllUsers</span><span class=p>()</span><span class=o>:</span> <span class=nx>Observable</span><span class=p>&lt;</span><span class=nt>User</span><span class=err>[]</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>of</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>300</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>deleteUser</span><span class=p>(</span><span class=nx>userId</span>: <span class=kt>number</span><span class=p>)</span><span class=o>:</span> <span class=nx>Observable</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>index</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>findIndex</span><span class=p>(</span><span class=nx>u</span> <span class=o>=&gt;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>userId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>!==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>of</span><span class=p>(</span><span class=k>void</span> <span class=mi>0</span><span class=p>).</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>delay</span><span class=p>(</span><span class=mi>300</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>throwError</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Utilisateur non trouvé&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>getToken</span><span class=p>()</span><span class=o>:</span> <span class=kt>string</span> <span class=o>|</span> <span class=kc>null</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>user</span> <span class=o>?</span> <span class=sb>`mock-token-</span><span class=si>${</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span> <span class=o>:</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Méthode pour définir l&#39;utilisateur connecté (utilisée après login)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>setCurrentUser</span><span class=p>(</span><span class=nx>user</span>: <span class=kt>User</span><span class=p>)</span><span class=o>:</span> <span class=k>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>localStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s1>&#39;currentUser&#39;</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>user</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=implémentation-du-formulaire-de-login><strong>Implémentation du formulaire de login</strong></h3><p>import { Component, inject } from &lsquo;@angular/core&rsquo;;
import { CommonModule } from &lsquo;@angular/common&rsquo;;
import { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from &lsquo;@angular/forms&rsquo;;
import { Router } from &lsquo;@angular/router&rsquo;;
import { AuthService } from &lsquo;../../services/auth.service&rsquo;;</p><p>@Component({
selector: &lsquo;app-login&rsquo;,
standalone: true,
imports: [CommonModule, ReactiveFormsModule],
template: `<div class="min-h-screen w-fit text-black
flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"><div class="w-full space-y-8"><div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Connexion à votre compte</h2></div></p><pre><code>    &lt;form [formGroup]=&quot;loginForm&quot; (ngSubmit)=&quot;onSubmit()&quot; class=&quot;mt-8 space-y-6&quot;&gt;
      &lt;!-- Email --&gt;
      &lt;div&gt;
        &lt;label for=&quot;email&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
          Adresse email
        &lt;/label&gt;
        &lt;input
          id=&quot;email&quot;
          type=&quot;email&quot;
          formControlName=&quot;email&quot;
          class=&quot;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&quot;
          [class.border-red-500]=&quot;isFieldInvalid('email')&quot;
        /&gt;
        @if (isFieldInvalid('email')) {
          &lt;p class=&quot;mt-1 text-sm text-red-600&quot;&gt;
            {{ getFieldError('email') }}
          &lt;/p&gt;
        }
      &lt;/div&gt;

      &lt;!-- Password --&gt;
      &lt;div&gt;
        &lt;label for=&quot;password&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
          Mot de passe
        &lt;/label&gt;
        &lt;input
          id=&quot;password&quot;
          type=&quot;password&quot;
          formControlName=&quot;password&quot;
          class=&quot;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&quot;
          [class.border-red-500]=&quot;isFieldInvalid('password')&quot;
        /&gt;
        @if (isFieldInvalid('password')) {
          &lt;p class=&quot;mt-1 text-sm text-red-600&quot;&gt;
            {{ getFieldError('password') }}
          &lt;/p&gt;
        }
      &lt;/div&gt;

      &lt;!-- Submit Button --&gt;
      &lt;div&gt;
        &lt;button
          type=&quot;submit&quot;
          [disabled]=&quot;loginForm.invalid || loading()&quot;
          class=&quot;group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50&quot;
        &gt;
          @if (loading()) {
            &lt;span class=&quot;inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2&quot;&gt;&lt;/span&gt;
            Connexion en cours...
          } @else {
            Se connecter
          }
        &lt;/button&gt;
      &lt;/div&gt;

      &lt;!-- Error Message --&gt;
      @if (error()) {
        &lt;div class=&quot;bg-red-50 border border-red-200 rounded-md p-4&quot;&gt;
          &lt;p class=&quot;text-sm text-red-600&quot;&gt;{{ error() }}&lt;/p&gt;
        &lt;/div&gt;
      }
    &lt;/form&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>`
})
export class LoginComponent {
private fb = inject(FormBuilder);
private authService = inject(AuthService);
private router = inject(Router);</p><p>loginForm: FormGroup;
loading = signal(false);
error = signal<string>(&rsquo;&rsquo;);</p><p>constructor() {
this.loginForm = this.fb.group({
email: [&rsquo;&rsquo;, [Validators.required, Validators.email]],
password: [&rsquo;&rsquo;, [Validators.required, Validators.minLength(6)]]
});
}</p><p>onSubmit() {
if (this.loginForm.valid) {
this.loading.set(true);
this.error.set(&rsquo;&rsquo;);</p><pre><code>  this.authService.login(this.loginForm.value).subscribe({
    next: (user) =&gt; {
      this.loading.set(false);
      this.router.navigate(['/todos']);
    },
    error: (err) =&gt; {
      this.loading.set(false);
      this.error.set(err.message || 'Erreur de connexion');
    }
  });
}
</code></pre><p>}</p><p>isFieldInvalid(fieldName: string): boolean {
const field = this.loginForm.get(fieldName);
return !!(field && field.invalid && (field.dirty || field.touched));
}</p><p>getFieldError(fieldName: string): string {
const field = this.loginForm.get(fieldName);
if (field?.errors) {
if (field.errors[&lsquo;required&rsquo;]) return &lsquo;Ce champ est requis&rsquo;;
if (field.errors[&rsquo;email&rsquo;]) return &lsquo;Format d'email invalide&rsquo;;
if (field.errors[&lsquo;minlength&rsquo;]) return <code>Minimum ${field.errors['minlength'].requiredLength} caractères</code>;
}
return &lsquo;&rsquo;;
}
}</p><h3 id=mise-à-jour-du-header-avec-gestion-d><strong>Mise à jour du header avec gestion d&rsquo;authentification</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/shared/components/header/header.component.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Component</span><span class=p>,</span> <span class=nx>inject</span><span class=p>,</span> <span class=nx>signal</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>RouterLink</span><span class=p>,</span> <span class=nx>Router</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>AuthService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../../features/auth/services/auth&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>User</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../../features/auth/models/user.model&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Component</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>selector</span><span class=o>:</span> <span class=s1>&#39;app-header&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>standalone</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>imports</span><span class=o>:</span> <span class=p>[</span><span class=nx>RouterLink</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;header class=&#34;bg-blue-600 text-white p-4&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;div class=&#34;container mx-auto flex justify-between items-center&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;h1 class=&#34;text-2xl font-bold&#34;&gt;TodoList App&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;nav&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;ul class=&#34;flex space-x-4&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (currentUser()) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;li&gt;&lt;a routerLink=&#34;/todos&#34; class=&#34;hover:text-blue-200&#34;&gt;Todos&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              @if (currentUser()?.role === &#39;admin&#39;) {
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;li&gt;&lt;a routerLink=&#34;/admin&#34; class=&#34;hover:text-blue-200&#34;&gt;Admin&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              }
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;li&gt;&lt;button (click)=&#34;logout()&#34; class=&#34;hover:text-blue-200&#34;&gt;Logout&lt;/button&gt;&lt;/li&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            } @else {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;li&gt;&lt;a routerLink=&#34;/auth/login&#34; class=&#34;hover:text-blue-200&#34;&gt;Login&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;li&gt;&lt;a routerLink=&#34;/auth/register&#34; class=&#34;hover:text-blue-200&#34;&gt;Register&lt;/a&gt;&lt;/li&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/ul&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/nav&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/header&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>styles</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>HeaderComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>authService</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>AuthService</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>Router</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>currentUser</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>currentUser$</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Utiliser directement le signal du service
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>currentUser</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>currentUser$</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>logout() {</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>logout</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>router</span><span class=p>.</span><span class=nx>navigate</span><span class=p>([</span><span class=s1>&#39;/auth/login&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=mise-à-jour-des-routes-d><strong>Mise à jour des routes d&rsquo;authentification</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/features/auth/auth.routes.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Routes</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>LoginComponent</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./components/login/login&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>AUTH_ROUTES</span>: <span class=kt>Routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>component</span>: <span class=kt>LoginComponent</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;register&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// TODO: Ajouter RegisterComponent dans la Partie 2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>redirectTo</span><span class=o>:</span> <span class=s1>&#39;/todos&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirectTo</span><span class=o>:</span> <span class=s1>&#39;login&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>pathMatch</span><span class=o>:</span> <span class=s1>&#39;full&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-test-fonctionnel---étape-21--formulaires-réactifs>🧪 Test fonctionnel - Étape 2.1 : Formulaires Réactifs</h2><h3 id=vérifications-à-effectuer-><strong>Vérifications à effectuer :</strong></h3><h4 id=1-test-du-formulaire-de-login><strong>1. Test du formulaire de login</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Lancer l&#39;application</span>
</span></span><span class=line><span class=cl>ng serve
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Aller sur http://localhost:4200/auth/login</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Le formulaire s&rsquo;affiche correctement</li><li><input disabled type=checkbox> Les champs email et password sont présents</li><li><input disabled type=checkbox> Le bouton &ldquo;Se connecter&rdquo; est désactivé si le formulaire est invalide</li><li><input disabled type=checkbox> La validation email fonctionne (format invalide → erreur)</li><li><input disabled type=checkbox> La validation password fonctionne (moins de 6 caractères → erreur)</li><li><input disabled type=checkbox> Le bouton se connecte avec les identifiants : <code>admin@example.com</code> / <code>admin123</code></li><li><input disabled type=checkbox> Après connexion, redirection vers <code>/todos</code></li></ul><h4 id=2-test-de-la-validation-en-temps-réel><strong>2. Test de la validation en temps réel</strong></h4><ul><li><input disabled type=checkbox> Taper un email invalide → message d&rsquo;erreur apparaît</li><li><input disabled type=checkbox> Taper un mot de passe court → message d&rsquo;erreur apparaît</li><li><input disabled type=checkbox> Corriger les erreurs → messages disparaissent</li><li><input disabled type=checkbox> Le bouton s&rsquo;active quand le formulaire est valide</li></ul><h4 id=3-test-des-erreurs-de-connexion><strong>3. Test des erreurs de connexion</strong></h4><ul><li><input disabled type=checkbox> Essayer de se connecter avec des identifiants invalides</li><li><input disabled type=checkbox> Vérifier que le message d&rsquo;erreur s&rsquo;affiche</li><li><input disabled type=checkbox> Vérifier que le bouton de chargement fonctionne</li></ul><p><strong>🔧 Debug en cas de problème :</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Vérifier les erreurs dans la console</span>
</span></span><span class=line><span class=cl>F12 → Console
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier que le composant est bien créé</span>
</span></span><span class=line><span class=cl>ng generate component features/auth/components/login --dry-run
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>
### **🔧 Corrections importantes apportées**

#### **Types et interfaces**
- **User interface** : Ajout de la propriété `name` manquante
- **RegisterRequest** : Ajout de la propriété `name` pour l&#39;inscription
- **Passwords object** : Typage correct avec `{ [key: string]: string }`

#### **Signals vs Observables**
- **Header component** : Utilisation directe du signal `currentUser$` du service
- **Pas de subscribe** : Les signals n&#39;utilisent pas `.subscribe()` comme les Observables

#### **Gestion d&#39;état**
- **localStorage** : Persistance de session avec sauvegarde/restauration automatique
- **Navigation dynamique** : Header adaptatif selon l&#39;état de connexion

### **Explication technique : FormBuilder et FormGroup**
- **Pattern Builder** : Simplifie la création de formulaires complexes
- **Type Safety** : TypeScript peut inférer les types des contrôles
- **Réactivité** : Intégration native avec les Signals d&#39;Angular 20+

#### **📋 FormGroup**
- **Conteneur de contrôles** : Gère un ensemble de FormControl
- **Validation globale** : Peut valider l&#39;ensemble du formulaire
- **État réactif** : Émet des événements lors des changements

#### **🎛️ FormControl**
- **Contrôle individuel** : Gère un champ de formulaire
- **Validation locale** : Validators appliqués au niveau du champ
- **État en temps réel** : dirty, touched, valid, etc.

---

## 🛡️ Étape 2.2 : Guards de Protection

### **Pourquoi les Guards ?**

Les Guards permettent de contrôler l&#39;accès aux routes selon des conditions métier :

#### **🔒 Sécurité**
- **Protection des routes** : Empêcher l&#39;accès non autorisé
- **Redirection automatique** : Rediriger vers login si non authentifié
- **Validation des permissions** : Vérifier les rôles utilisateur

#### **🎯 Expérience utilisateur**
- **Navigation fluide** : Redirection automatique sans erreur 404
- **Feedback immédiat** : L&#39;utilisateur sait pourquoi il ne peut pas accéder
- **État cohérent** : L&#39;application reste dans un état valide

### **Création du Guard d&#39;authentification**

```typescript
// src/app/core/guards/auth.guard.ts
import { inject } from &#39;@angular/core&#39;;
import { CanActivateFn, Router } from &#39;@angular/router&#39;;
import { AuthService } from &#39;../../features/auth/services/auth.service&#39;;
import { map, take } from &#39;rxjs/operators&#39;;

export const authGuard: CanActivateFn = (route, state) =&gt; {
  const authService = inject(AuthService);
  const router = inject(Router);

  return authService.currentUser$.pipe(
    take(1), // Prendre seulement la première valeur
    map(user =&gt; {
      if (user) {
        return true; // Accès autorisé
      } else {
        // Rediriger vers login avec l&#39;URL de retour
        router.navigate([&#39;/auth/login&#39;], {
          queryParams: { returnUrl: state.url }
        });
        return false; // Accès refusé
      }
    })
  );
};
</code></pre><h3 id=création-du-guard-admin><strong>Création du Guard admin</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/core/guards/admin.guard.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>inject</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>CanActivateFn</span><span class=p>,</span> <span class=nx>Router</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>AuthService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../features/auth/services/auth.service&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>map</span><span class=p>,</span> <span class=nx>take</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;rxjs/operators&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>adminGuard</span>: <span class=kt>CanActivateFn</span> <span class=o>=</span> <span class=p>(</span><span class=nx>route</span><span class=p>,</span> <span class=nx>state</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>authService</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>AuthService</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>Router</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>authService</span><span class=p>.</span><span class=nx>currentUser$</span><span class=p>.</span><span class=nx>pipe</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>take</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>map</span><span class=p>(</span><span class=nx>user</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>user</span> <span class=o>&amp;&amp;</span> <span class=nx>user</span><span class=p>.</span><span class=nx>role</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>true</span><span class=p>;</span> <span class=c1>// Accès admin autorisé
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Rediriger vers la page d&#39;accueil
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>router</span><span class=p>.</span><span class=nx>navigate</span><span class=p>([</span><span class=s1>&#39;/todos&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>false</span><span class=p>;</span> <span class=c1>// Accès refusé
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=application-des-guards-aux-routes><strong>Application des Guards aux routes</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/app.routes.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Routes</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>authGuard</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./core/guards/auth.guard&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>adminGuard</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./core/guards/admin.guard&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>routes</span>: <span class=kt>Routes</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>redirectTo</span><span class=o>:</span> <span class=s1>&#39;/todos&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>pathMatch</span><span class=o>:</span> <span class=s1>&#39;full&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;todos&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>canActivate</span><span class=o>:</span> <span class=p>[</span><span class=nx>authGuard</span><span class=p>],</span> <span class=c1>// Protection par authentification
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>loadChildren</span><span class=o>:</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./features/todos/todos.routes&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>m</span> <span class=o>=&gt;</span> <span class=nx>m</span><span class=p>.</span><span class=nx>TODOS_ROUTES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>loadChildren</span><span class=o>:</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./features/auth/auth.routes&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>m</span> <span class=o>=&gt;</span> <span class=nx>m</span><span class=p>.</span><span class=nx>AUTH_ROUTES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>path</span><span class=o>:</span> <span class=s1>&#39;admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>canActivate</span><span class=o>:</span> <span class=p>[</span><span class=nx>authGuard</span><span class=p>,</span> <span class=nx>adminGuard</span><span class=p>],</span> <span class=c1>// Protection admin
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>loadChildren</span><span class=o>:</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=kr>import</span><span class=p>(</span><span class=s1>&#39;./features/admin/admin.routes&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>m</span> <span class=o>=&gt;</span> <span class=nx>m</span><span class=p>.</span><span class=nx>ADMIN_ROUTES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>##</span> <span class=err>🧪</span> <span class=nx>Test</span> <span class=nx>fonctionnel</span> <span class=o>-</span> <span class=err>É</span><span class=nx>tape</span> <span class=nx>2.2</span> : <span class=kt>Guards</span> <span class=nx>de</span> <span class=nx>Protection</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>###</span> <span class=o>**</span><span class=nx>Vérifications</span> <span class=err>à</span> <span class=nx>effectuer</span> <span class=o>:**</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>####</span> <span class=o>**</span><span class=mi>1</span><span class=p>.</span> <span class=nx>Test</span> <span class=nx>du</span> <span class=nx>AuthGuard</span><span class=o>**</span>
</span></span><span class=line><span class=cl><span class=sb>```bash
</span></span></span><span class=line><span class=cl><span class=sb># Aller sur http://localhost:4200/todos (sans être connecté)
</span></span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Redirection automatique vers <code>/auth/login</code></li><li><input disabled type=checkbox> L&rsquo;URL de retour est sauvegardée dans les query params</li><li><input disabled type=checkbox> Après connexion, retour automatique vers <code>/todos</code></li></ul><h4 id=2-test-du-adminguard><strong>2. Test du AdminGuard</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Se connecter avec un compte utilisateur normal</span>
</span></span><span class=line><span class=cl><span class=c1># user@example.com / user123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Essayer d&#39;accéder à http://localhost:4200/admin</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Redirection vers <code>/todos</code> (accès refusé)</li><li><input disabled type=checkbox> Se connecter avec <code>admin@example.com</code> / <code>admin123</code></li><li><input disabled type=checkbox> Accès à <code>/admin</code> autorisé</li></ul><h4 id=3-test-de-la-navigation><strong>3. Test de la navigation</strong></h4><ul><li><input disabled type=checkbox> Cliquer sur &ldquo;Admin&rdquo; dans le header (si connecté en tant qu&rsquo;admin)</li><li><input disabled type=checkbox> Vérifier que la navigation fonctionne correctement</li><li><input disabled type=checkbox> Tester la déconnexion et vérifier les redirections</li></ul><p><strong>🔧 Debug en cas de problème :</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Vérifier les routes dans la console</span>
</span></span><span class=line><span class=cl>F12 → Console → Vérifier les logs de navigation
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier que les guards sont bien appliqués</span>
</span></span><span class=line><span class=cl>ng build --configuration development
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>
### **Explication technique : CanActivateFn vs CanActivate**

#### **🆕 CanActivateFn (Angular 14+)**
- **Functional Guards** : Plus moderne et flexible
- **Injection simplifiée** : Utilise `inject()` au lieu du constructeur
- **Tree-shaking** : Meilleure optimisation du bundle
- **Composition** : Plus facile de combiner plusieurs guards

#### **🔄 Observable vs Promise**
- **Observable** : Permet l&#39;annulation et la réactivité
- **take(1)** : Évite les fuites mémoire en se désabonnant automatiquement
- **map()** : Transforme la valeur sans créer de nouvel Observable

---

## 🔄 Étape 2.3 : Lazy Loading Avancé

### **Pourquoi le Lazy Loading ?**

Le lazy loading améliore significativement les performances :

#### **⚡ Performance**
- **Bundle initial réduit** : Seuls les modules nécessaires sont chargés
- **Chargement à la demande** : Les modules se chargent quand on en a besoin
- **Cache intelligent** : Les modules restent en cache après premier chargement

#### **📱 Expérience mobile**
- **Temps de chargement réduit** : Particulièrement important sur mobile
- **Bande passante économisée** : Seulement ce qui est nécessaire
- **Batterie préservée** : Moins de traitement initial

### **Configuration du lazy loading**

```typescript
// src/app/features/auth/auth.routes.ts
import { Routes } from &#39;@angular/router&#39;;
import { LoginComponent } from &#39;./components/login.component&#39;;
import { RegisterComponent } from &#39;./components/register.component&#39;;

export const AUTH_ROUTES: Routes = [
  {
    path: &#39;login&#39;,
    component: LoginComponent
  },
  {
    path: &#39;register&#39;,
    component: RegisterComponent
  },
  {
    path: &#39;&#39;,
    redirectTo: &#39;login&#39;,
    pathMatch: &#39;full&#39;
  }
];
</code></pre><h3 id=composant-register-avec-validation-avancée><strong>Composant Register avec validation avancée</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/features/auth/components/register.component.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Component</span><span class=p>,</span> <span class=nx>inject</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>CommonModule</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/common&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>FormBuilder</span><span class=p>,</span> <span class=nx>FormGroup</span><span class=p>,</span> <span class=nx>Validators</span><span class=p>,</span> <span class=nx>ReactiveFormsModule</span><span class=p>,</span> <span class=nx>AbstractControl</span><span class=p>,</span> <span class=nx>ValidationErrors</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/forms&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Router</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>AuthService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../services/auth.service&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Validateur personnalisé pour la confirmation de mot de passe
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>passwordMatchValidator</span><span class=p>(</span><span class=nx>control</span>: <span class=kt>AbstractControl</span><span class=p>)</span><span class=o>:</span> <span class=nx>ValidationErrors</span> <span class=o>|</span> <span class=kc>null</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>password</span> <span class=o>=</span> <span class=nx>control</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>confirmPassword</span> <span class=o>=</span> <span class=nx>control</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s1>&#39;confirmPassword&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>password</span> <span class=o>&amp;&amp;</span> <span class=nx>confirmPassword</span> <span class=o>&amp;&amp;</span> <span class=nx>password</span><span class=p>.</span><span class=nx>value</span> <span class=o>!==</span> <span class=nx>confirmPassword</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>passwordMismatch</span>: <span class=kt>true</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Component</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>selector</span><span class=o>:</span> <span class=s1>&#39;app-register&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>standalone</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>imports</span><span class=o>:</span> <span class=p>[</span><span class=nx>CommonModule</span><span class=p>,</span> <span class=nx>ReactiveFormsModule</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;div class=&#34;min-h-screen text-black w-fit flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;div class=&#34;w-full space-y-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;h2 class=&#34;mt-6 text-center text-3xl font-extrabold text-gray-900&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            Créer un compte
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;form [formGroup]=&#34;registerForm&#34; (ngSubmit)=&#34;onSubmit()&#34; class=&#34;mt-8 space-y-6&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Nom --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;label for=&#34;name&#34; class=&#34;block text-sm font-medium text-gray-700&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              Nom complet
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/label&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;input
</span></span></span><span class=line><span class=cl><span class=sb>              id=&#34;name&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              type=&#34;text&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              formControlName=&#34;name&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              class=&#34;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              [class.border-red-500]=&#34;isFieldInvalid(&#39;name&#39;)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            /&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (isFieldInvalid(&#39;name&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;mt-1 text-sm text-red-600&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                {{ getFieldError(&#39;name&#39;) }}
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Email --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;label for=&#34;email&#34; class=&#34;block text-sm font-medium text-gray-700&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              Adresse email
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/label&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;input
</span></span></span><span class=line><span class=cl><span class=sb>              id=&#34;email&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              type=&#34;email&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              formControlName=&#34;email&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              class=&#34;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              [class.border-red-500]=&#34;isFieldInvalid(&#39;email&#39;)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            /&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (isFieldInvalid(&#39;email&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;mt-1 text-sm text-red-600&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                {{ getFieldError(&#39;email&#39;) }}
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Password --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;label for=&#34;password&#34; class=&#34;block text-sm font-medium text-gray-700&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              Mot de passe
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/label&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;input
</span></span></span><span class=line><span class=cl><span class=sb>              id=&#34;password&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              type=&#34;password&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              formControlName=&#34;password&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              class=&#34;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              [class.border-red-500]=&#34;isFieldInvalid(&#39;password&#39;)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            /&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (isFieldInvalid(&#39;password&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;mt-1 text-sm text-red-600&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                {{ getFieldError(&#39;password&#39;) }}
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Confirm Password --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;label for=&#34;confirmPassword&#34; class=&#34;block text-sm font-medium text-gray-700&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              Confirmer le mot de passe
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/label&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;input
</span></span></span><span class=line><span class=cl><span class=sb>              id=&#34;confirmPassword&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              type=&#34;password&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              formControlName=&#34;confirmPassword&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              class=&#34;mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              [class.border-red-500]=&#34;isFieldInvalid(&#39;confirmPassword&#39;)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            /&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (isFieldInvalid(&#39;confirmPassword&#39;)) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;mt-1 text-sm text-red-600&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                {{ getFieldError(&#39;confirmPassword&#39;) }}
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Submit Button --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>              type=&#34;submit&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              [disabled]=&#34;registerForm.invalid || loading()&#34;
</span></span></span><span class=line><span class=cl><span class=sb>              class=&#34;group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            &gt;
</span></span></span><span class=line><span class=cl><span class=sb>              @if (loading()) {
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;span class=&#34;inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2&#34;&gt;&lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                Création en cours...
</span></span></span><span class=line><span class=cl><span class=sb>              } @else {
</span></span></span><span class=line><span class=cl><span class=sb>                Créer le compte
</span></span></span><span class=line><span class=cl><span class=sb>              }
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;!-- Error Message --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          @if (error()) {
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;div class=&#34;bg-red-50 border border-red-200 rounded-md p-4&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;text-sm text-red-600&#34;&gt;{{ error() }}&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          }
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/form&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>RegisterComponent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>fb</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>FormBuilder</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>authService</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>AuthService</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>Router</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>registerForm</span>: <span class=kt>FormGroup</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>loading</span> <span class=o>=</span> <span class=nx>signal</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>error</span> <span class=o>=</span> <span class=nx>signal</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>&gt;(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>registerForm</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>fb</span><span class=p>.</span><span class=nx>group</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>Validators</span><span class=p>.</span><span class=nx>required</span><span class=p>,</span> <span class=nx>Validators</span><span class=p>.</span><span class=nx>minLength</span><span class=p>(</span><span class=mi>2</span><span class=p>)]],</span>
</span></span><span class=line><span class=cl>      <span class=nx>email</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>Validators</span><span class=p>.</span><span class=nx>required</span><span class=p>,</span> <span class=nx>Validators</span><span class=p>.</span><span class=nx>email</span><span class=p>]],</span>
</span></span><span class=line><span class=cl>      <span class=nx>password</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>Validators</span><span class=p>.</span><span class=nx>required</span><span class=p>,</span> <span class=nx>Validators</span><span class=p>.</span><span class=nx>minLength</span><span class=p>(</span><span class=mi>6</span><span class=p>)]],</span>
</span></span><span class=line><span class=cl>      <span class=nx>confirmPassword</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>Validators</span><span class=p>.</span><span class=nx>required</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=p>{</span> <span class=nx>validators</span>: <span class=kt>passwordMatchValidator</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>onSubmit() {</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>registerForm</span><span class=p>.</span><span class=nx>valid</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>loading</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>error</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>confirmPassword</span><span class=p>,</span> <span class=p>...</span><span class=nx>userData</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>registerForm</span><span class=p>.</span><span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>register</span><span class=p>(</span><span class=nx>userData</span><span class=p>).</span><span class=nx>subscribe</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=o>:</span> <span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>loading</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>router</span><span class=p>.</span><span class=nx>navigate</span><span class=p>([</span><span class=s1>&#39;/todos&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>error</span><span class=o>:</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>loading</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>error</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>err</span><span class=p>.</span><span class=nx>message</span> <span class=o>||</span> <span class=s1>&#39;Erreur lors de la création du compte&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>isFieldInvalid</span><span class=p>(</span><span class=nx>fieldName</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=kr>boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>field</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>registerForm</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>fieldName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>!!</span><span class=p>(</span><span class=nx>field</span> <span class=o>&amp;&amp;</span> <span class=nx>field</span><span class=p>.</span><span class=nx>invalid</span> <span class=o>&amp;&amp;</span> <span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>dirty</span> <span class=o>||</span> <span class=nx>field</span><span class=p>.</span><span class=nx>touched</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>getFieldError</span><span class=p>(</span><span class=nx>fieldName</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>field</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>registerForm</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>fieldName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>field</span><span class=o>?</span><span class=p>.</span><span class=nx>errors</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>errors</span><span class=p>[</span><span class=s1>&#39;required&#39;</span><span class=p>])</span> <span class=k>return</span> <span class=s1>&#39;Ce champ est requis&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>errors</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>])</span> <span class=k>return</span> <span class=s1>&#39;Format d\&#39;email invalide&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>errors</span><span class=p>[</span><span class=s1>&#39;minlength&#39;</span><span class=p>])</span> <span class=k>return</span> <span class=sb>`Minimum </span><span class=si>${</span><span class=nx>field</span><span class=p>.</span><span class=nx>errors</span><span class=p>[</span><span class=s1>&#39;minlength&#39;</span><span class=p>].</span><span class=nx>requiredLength</span><span class=si>}</span><span class=sb> caractères`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>field</span><span class=p>.</span><span class=nx>errors</span><span class=p>[</span><span class=s1>&#39;passwordMismatch&#39;</span><span class=p>])</span> <span class=k>return</span> <span class=s1>&#39;Les mots de passe ne correspondent pas&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=explication-technique--validateurs-personnalisés><strong>Explication technique : Validateurs personnalisés</strong></h3><h4 id=-validateur-personnalisé><strong>🔧 Validateur personnalisé</strong></h4><ul><li><strong>Fonction pure</strong> : Pas d&rsquo;effets de bord, facilement testable</li><li><strong>Validation croisée</strong> : Peut accéder à plusieurs contrôles</li><li><strong>Réutilisabilité</strong> : Peut être utilisé dans d&rsquo;autres formulaires</li></ul><h4 id=-validators-angular><strong>📊 Validators Angular</strong></h4><ul><li><strong>Validators.required</strong> : Champ obligatoire</li><li><strong>Validators.email</strong> : Format email valide</li><li><strong>Validators.minLength(n)</strong> : Longueur minimale</li><li><strong>Validators.pattern(regex)</strong> : Expression régulière</li></ul><hr><h2 id=-test-fonctionnel---étape-23--lazy-loading-et-register>🧪 Test fonctionnel - Étape 2.3 : Lazy Loading et Register</h2><h3 id=vérifications-à-effectuer--1><strong>Vérifications à effectuer :</strong></h3><h4 id=1-test-du-formulaire-de-register><strong>1. Test du formulaire de register</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Aller sur http://localhost:4200/auth/register</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Le formulaire s&rsquo;affiche correctement avec tous les champs</li><li><input disabled type=checkbox> Validation du nom (minimum 2 caractères)</li><li><input disabled type=checkbox> Validation de l&rsquo;email (format valide)</li><li><input disabled type=checkbox> Validation du mot de passe (minimum 6 caractères)</li><li><input disabled type=checkbox> Validation de la confirmation de mot de passe</li><li><input disabled type=checkbox> Les mots de passe doivent correspondre</li><li><input disabled type=checkbox> Création d&rsquo;un nouveau compte fonctionne</li></ul><h4 id=2-test-du-lazy-loading><strong>2. Test du lazy loading</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Ouvrir les DevTools (F12)</span>
</span></span><span class=line><span class=cl><span class=c1># Aller dans l&#39;onglet Network</span>
</span></span><span class=line><span class=cl><span class=c1># Naviguer entre les pages</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Chargement initial rapide (pas de gros bundle)</li><li><input disabled type=checkbox> Nouveaux chunks chargés lors de la navigation</li><li><input disabled type=checkbox> Les modules se chargent à la demande</li><li><input disabled type=checkbox> Pas d&rsquo;erreurs de chargement dans la console</li></ul><h4 id=3-test-de-la-validation-croisée><strong>3. Test de la validation croisée</strong></h4><ul><li><input disabled type=checkbox> Taper des mots de passe différents → erreur</li><li><input disabled type=checkbox> Corriger pour qu&rsquo;ils correspondent → erreur disparaît</li><li><input disabled type=checkbox> Le bouton s&rsquo;active seulement si tout est valide</li></ul><p><strong>🔧 Debug en cas de problème :</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Vérifier les erreurs de compilation</span>
</span></span><span class=line><span class=cl>ng build --configuration development
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier les chunks générés</span>
</span></span><span class=line><span class=cl>ng build --stats-json
</span></span></code></pre></td></tr></table></div></div><h2 id=-étape-24--interface-admin-1>🎨 Étape 2.4 : Interface Admin</h2><h3 id=pourquoi-une-interface-admin-><strong>Pourquoi une interface admin ?</strong></h3><p>L&rsquo;interface admin permet de gérer l&rsquo;application de manière centralisée :</p><h4 id=-gestion-des-utilisateurs><strong>👥 Gestion des utilisateurs</strong></h4><ul><li><strong>Création/suppression</strong> : Gérer les comptes utilisateurs</li><li><strong>Attribution de rôles</strong> : Donner des permissions spécifiques</li><li><strong>Surveillance</strong> : Voir qui utilise l&rsquo;application</li></ul><h4 id=-gestion-des-tickets><strong>📋 Gestion des tickets</strong></h4><ul><li><strong>Répartition</strong> : Assigner des tickets aux utilisateurs</li><li><strong>Suivi</strong> : Voir l&rsquo;état de tous les tickets</li><li><strong>Modération</strong> : Supprimer ou modifier des tickets</li></ul><h3 id=composant-admin-principal><strong>Composant Admin principal</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/features/admin/components/admin.component.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Component</span><span class=p>,</span> <span class=nx>inject</span><span class=p>,</span> <span class=nx>OnInit</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>CommonModule</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/common&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Router</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>AuthService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../auth/services/auth.service&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>TodoService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../todos/services/todo.service&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>User</span><span class=p>,</span> <span class=nx>Todo</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../auth/models/user.model&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Component</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>selector</span><span class=o>:</span> <span class=s1>&#39;app-admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>standalone</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>imports</span><span class=o>:</span> <span class=p>[</span><span class=nx>CommonModule</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;div class=&#34;max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;div class=&#34;mb-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;h1 class=&#34;text-3xl font-bold text-gray-900&#34;&gt;Interface d&#39;Administration&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;p class=&#34;text-gray-600 mt-2&#34;&gt;Gérez les utilisateurs et les tickets&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;!-- Navigation Admin --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;div class=&#34;mb-8&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;nav class=&#34;flex space-x-4&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>            (click)=&#34;activeTab = &#39;users&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.bg-blue-600]=&#34;activeTab === &#39;users&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.text-white]=&#34;activeTab === &#39;users&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.text-gray-700]=&#34;activeTab !== &#39;users&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            class=&#34;px-4 py-2 rounded-md font-medium hover:bg-blue-700 hover:text-white transition-colors&#34;
</span></span></span><span class=line><span class=cl><span class=sb>          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>            Utilisateurs
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>            (click)=&#34;activeTab = &#39;tickets&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.bg-blue-600]=&#34;activeTab === &#39;tickets&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.text-white]=&#34;activeTab === &#39;tickets&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            [class.text-gray-700]=&#34;activeTab !== &#39;tickets&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>            class=&#34;px-4 py-2 rounded-md font-medium hover:bg-blue-700 hover:text-white transition-colors&#34;
</span></span></span><span class=line><span class=cl><span class=sb>          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>            Tickets
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/nav&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;!-- Contenu des onglets --&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      @if (activeTab === &#39;users&#39;) {
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;div class=&#34;bg-white shadow rounded-lg&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div class=&#34;px-6 py-4 border-b border-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;h2 class=&#34;text-xl font-semibold text-gray-900&#34;&gt;Gestion des Utilisateurs&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div class=&#34;p-6&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (users().length &gt; 0) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;div class=&#34;overflow-x-auto&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;table class=&#34;min-w-full divide-y divide-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;thead class=&#34;bg-gray-50&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    &lt;tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Utilisateur
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Rôle
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Actions
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    &lt;/tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;/thead&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;tbody class=&#34;bg-white divide-y divide-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    @for (user of users(); track user.id) {
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;div class=&#34;flex items-center&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;div class=&#34;flex-shrink-0 h-10 w-10&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                              &lt;div class=&#34;h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                                &lt;span class=&#34;text-sm font-medium text-gray-700&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                                  {{ user.name.charAt(0).toUpperCase() }}
</span></span></span><span class=line><span class=cl><span class=sb>                                &lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                              &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;div class=&#34;ml-4&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                              &lt;div class=&#34;text-sm font-medium text-gray-900&#34;&gt;{{ user.name }}&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                              &lt;div class=&#34;text-sm text-gray-500&#34;&gt;{{ user.email }}&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;span
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-red-100]=&#34;user.role === &#39;admin&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-red-800]=&#34;user.role === &#39;admin&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-green-100]=&#34;user.role === &#39;user&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-green-800]=&#34;user.role === &#39;user&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            class=&#34;px-2 inline-flex text-xs leading-5 font-semibold rounded-full&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            {{ user.role | titlecase }}
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap text-sm font-medium&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          @if (user.role !== &#39;admin&#39;) {
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>                              (click)=&#34;deleteUser(user.id)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                              class=&#34;text-red-600 hover:text-red-900&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                              Supprimer
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          } @else {
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;span class=&#34;text-gray-400&#34;&gt;Admin protégé&lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          }
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    }
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;/tbody&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;/table&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            } @else {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;text-gray-500 text-center py-8&#34;&gt;Aucun utilisateur trouvé&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      }
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>      @if (activeTab === &#39;tickets&#39;) {
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;div class=&#34;bg-white shadow rounded-lg&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div class=&#34;px-6 py-4 border-b border-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            &lt;h2 class=&#34;text-xl font-semibold text-gray-900&#34;&gt;Gestion des Tickets&lt;/h2&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;div class=&#34;p-6&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            @if (todos().length &gt; 0) {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;div class=&#34;overflow-x-auto&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;table class=&#34;min-w-full divide-y divide-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;thead class=&#34;bg-gray-50&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    &lt;tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Ticket
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Statut
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Priorité
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Assigné à
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;th class=&#34;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        Actions
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/th&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    &lt;/tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;/thead&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;tbody class=&#34;bg-white divide-y divide-gray-200&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    @for (todo of todos(); track todo.id) {
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;div class=&#34;text-sm font-medium text-gray-900&#34;&gt;{{ todo.title }}&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          @if (todo.description) {
</span></span></span><span class=line><span class=cl><span class=sb>                            &lt;div class=&#34;text-sm text-gray-500&#34;&gt;{{ todo.description }}&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          }
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;span
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-yellow-100]=&#34;todo.status === &#39;todo&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-yellow-800]=&#34;todo.status === &#39;todo&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-blue-100]=&#34;todo.status === &#39;in-progress&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-blue-800]=&#34;todo.status === &#39;in-progress&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-green-100]=&#34;todo.status === &#39;done&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-green-800]=&#34;todo.status === &#39;done&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            class=&#34;px-2 inline-flex text-xs leading-5 font-semibold rounded-full&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            {{ todo.status | titlecase }}
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;span
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-red-100]=&#34;todo.priority === &#39;high&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-red-800]=&#34;todo.priority === &#39;high&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-yellow-100]=&#34;todo.priority === &#39;medium&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-yellow-800]=&#34;todo.priority === &#39;medium&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.bg-green-100]=&#34;todo.priority === &#39;low&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            [class.text-green-800]=&#34;todo.priority === &#39;low&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            class=&#34;px-2 inline-flex text-xs leading-5 font-semibold rounded-full&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            {{ todo.priority | titlecase }}
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap text-sm text-gray-900&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          {{ todo.assignedTo || &#39;Non assigné&#39; }}
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;td class=&#34;px-6 py-4 whitespace-nowrap text-sm font-medium&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>                            (click)=&#34;deleteTodo(todo.id)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            class=&#34;text-red-600 hover:text-red-900 mr-3&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            Supprimer
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;button
</span></span></span><span class=line><span class=cl><span class=sb>                            (click)=&#34;assignTodo(todo)&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                            class=&#34;text-blue-600 hover:text-blue-900&#34;
</span></span></span><span class=line><span class=cl><span class=sb>                          &gt;
</span></span></span><span class=line><span class=cl><span class=sb>                            Assigner
</span></span></span><span class=line><span class=cl><span class=sb>                          &lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        &lt;/td&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                      &lt;/tr&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                    }
</span></span></span><span class=line><span class=cl><span class=sb>                  &lt;/tbody&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                &lt;/table&gt;
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            } @else {
</span></span></span><span class=line><span class=cl><span class=sb>              &lt;p class=&#34;text-gray-500 text-center py-8&#34;&gt;Aucun ticket trouvé&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            }
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      }
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  </span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>AdminComponent</span> <span class=kr>implements</span> <span class=nx>OnInit</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>authService</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>AuthService</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>todoService</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>TodoService</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=nx>Router</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>activeTab</span> <span class=o>=</span> <span class=nx>signal</span><span class=o>&lt;</span><span class=s1>&#39;users&#39;</span> <span class=o>|</span> <span class=s1>&#39;tickets&#39;</span><span class=o>&gt;</span><span class=p>(</span><span class=s1>&#39;users&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>users</span> <span class=o>=</span> <span class=nx>signal</span><span class=p>&lt;</span><span class=nt>User</span><span class=err>[]</span><span class=p>&gt;([]);</span>
</span></span><span class=line><span class=cl>  <span class=nx>todos</span> <span class=o>=</span> <span class=nx>signal</span><span class=p>&lt;</span><span class=nt>Todo</span><span class=err>[]</span><span class=p>&gt;([]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>ngOnInit() {</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Vérifier que l&#39;utilisateur est admin
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>currentUser</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>getCurrentUser</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>currentUser</span> <span class=o>||</span> <span class=nx>currentUser</span><span class=p>.</span><span class=nx>role</span> <span class=o>!==</span> <span class=s1>&#39;admin&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>router</span><span class=p>.</span><span class=nx>navigate</span><span class=p>([</span><span class=s1>&#39;/todos&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Charger les données
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>loadUsers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>loadTodos</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>loadUsers() {</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>users</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>getAllUsers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>users</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>users</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Erreur lors du chargement des utilisateurs:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>loadTodos() {</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>todos</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>todoService</span><span class=p>.</span><span class=nx>getAllTodos</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>todos</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Erreur lors du chargement des todos:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>deleteUser</span><span class=p>(</span><span class=nx>userId</span>: <span class=kt>number</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>confirm</span><span class=p>(</span><span class=s1>&#39;Êtes-vous sûr de vouloir supprimer cet utilisateur ?&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>authService</span><span class=p>.</span><span class=nx>deleteUser</span><span class=p>(</span><span class=nx>userId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>loadUsers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Erreur lors de la suppression:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>deleteTodo</span><span class=p>(</span><span class=nx>todoId</span>: <span class=kt>number</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>confirm</span><span class=p>(</span><span class=s1>&#39;Êtes-vous sûr de vouloir supprimer ce ticket ?&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>todoService</span><span class=p>.</span><span class=nx>deleteTodo</span><span class=p>(</span><span class=nx>todoId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>loadTodos</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Erreur lors de la suppression:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>assignTodo</span><span class=p>(</span><span class=nx>todo</span>: <span class=kt>Todo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// TODO: Implémenter la logique d&#39;assignation
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Assigner le ticket:&#39;</span><span class=p>,</span> <span class=nx>todo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>##</span> <span class=err>🧪</span> <span class=nx>Test</span> <span class=nx>fonctionnel</span> <span class=o>-</span> <span class=err>É</span><span class=nx>tape</span> <span class=nx>2.4</span> : <span class=kt>Interface</span> <span class=nx>Admin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>###</span> <span class=o>**</span><span class=nx>Vérifications</span> <span class=err>à</span> <span class=nx>effectuer</span> <span class=o>:**</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>####</span> <span class=o>**</span><span class=mi>1</span><span class=p>.</span> <span class=nx>Test</span> <span class=nx>de</span> <span class=nx>l</span><span class=s1>&#39;accès admin**
</span></span></span><span class=line><span class=cl><span class=s1>```bash
</span></span></span><span class=line><span class=cl><span class=s1># Se connecter en tant qu&#39;</span><span class=nx>admin</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>admin</span><span class=kd>@example</span><span class=p>.</span><span class=nx>com</span> <span class=o>/</span> <span class=nx>admin123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=nx>Aller</span> <span class=nx>sur</span> <span class=nx>http</span><span class=o>:</span><span class=c1>//localhost:4200/admin
</span></span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> L&rsquo;interface admin s&rsquo;affiche correctement</li><li><input disabled type=checkbox> Les onglets &ldquo;Utilisateurs&rdquo; et &ldquo;Tickets&rdquo; sont présents</li><li><input disabled type=checkbox> La liste des utilisateurs s&rsquo;affiche</li><li><input disabled type=checkbox> La liste des tickets s&rsquo;affiche</li><li><input disabled type=checkbox> Les rôles sont correctement affichés (Admin/User)</li></ul><h4 id=2-test-de-la-gestion-des-utilisateurs><strong>2. Test de la gestion des utilisateurs</strong></h4><ul><li><input disabled type=checkbox> Voir tous les utilisateurs dans le tableau</li><li><input disabled type=checkbox> Les admins sont marqués comme &ldquo;protégés&rdquo;</li><li><input disabled type=checkbox> Possibilité de supprimer un utilisateur normal</li><li><input disabled type=checkbox> Confirmation avant suppression</li></ul><h4 id=3-test-de-la-gestion-des-tickets><strong>3. Test de la gestion des tickets</strong></h4><ul><li><input disabled type=checkbox> Voir tous les tickets dans le tableau</li><li><input disabled type=checkbox> Les statuts sont correctement affichés (Todo, In Progress, Done)</li><li><input disabled type=checkbox> Les priorités sont correctement affichées (High, Medium, Low)</li><li><input disabled type=checkbox> Possibilité de supprimer un ticket</li><li><input disabled type=checkbox> Bouton &ldquo;Assigner&rdquo; présent (fonctionnalité à implémenter)</li></ul><h4 id=4-test-de-la-navigation><strong>4. Test de la navigation</strong></h4><ul><li><input disabled type=checkbox> Changement d&rsquo;onglet fonctionne</li><li><input disabled type=checkbox> Les données se rechargent correctement</li><li><input disabled type=checkbox> Pas d&rsquo;erreurs dans la console</li></ul><p><strong>🔧 Debug en cas de problème :</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Vérifier les permissions</span>
</span></span><span class=line><span class=cl>F12 → Console → Vérifier les logs d<span class=err>&#39;</span>authentification
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier les données</span>
</span></span><span class=line><span class=cl>F12 → Application → Local Storage → Vérifier le token
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>
### **Explication technique : Signals vs Observables**

#### **📡 Signals (Angular 20+)**
- **Performance optimale** : Détection de changements ultra-rapide
- **Syntaxe simplifiée** : `signal()` et `computed()` plus intuitifs
- **Tree-shaking** : Meilleure optimisation du bundle
- **Réactivité granulaire** : Seuls les composants qui utilisent le signal se mettent à jour

#### **🔄 Observables (RxJS)**
- **Puissance** : Opérateurs avancés (map, filter, switchMap, etc.)
- **Annulation** : Possibilité d&#39;annuler les requêtes
- **Composition** : Combinaison de plusieurs streams
- **Maturité** : Écosystème riche et stable

#### **🎯 Quand utiliser quoi ?**
- **Signals** : État local simple, performance critique
- **Observables** : Requêtes HTTP, événements complexes, composition de streams

---

## 🔧 Étape 2.5 : Intercepteurs HTTP

### **Pourquoi les Intercepteurs ?**

Les intercepteurs permettent de traiter toutes les requêtes HTTP de manière centralisée :

#### **🔐 Authentification**
- **Ajout automatique des tokens** : Pas besoin de les ajouter manuellement
- **Gestion des erreurs 401** : Redirection automatique vers login
- **Refresh des tokens** : Renouvellement transparent

#### **📊 Monitoring**
- **Logs centralisés** : Toutes les requêtes sont loggées
- **Métriques** : Temps de réponse, taux d&#39;erreur
- **Debugging** : Facilite le débogage des problèmes réseau

### **Création de l&#39;intercepteur d&#39;authentification**

```typescript
// src/app/core/interceptors/auth.interceptor.ts
import { Injectable } from &#39;@angular/core&#39;;
import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent, HttpErrorResponse } from &#39;@angular/common/http&#39;;
import { Observable, throwError } from &#39;rxjs&#39;;
import { catchError, switchMap } from &#39;rxjs/operators&#39;;
import { AuthService } from &#39;../../features/auth/services/auth.service&#39;;
import { Router } from &#39;@angular/router&#39;;

@Injectable()
export class AuthInterceptor implements HttpInterceptor {
  constructor(
    private authService: AuthService,
    private router: Router
  ) {}

  intercept(request: HttpRequest&lt;unknown&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;unknown&gt;&gt; {
    // Ajouter le token d&#39;authentification si disponible
    const token = this.authService.getToken();
    if (token) {
      request = request.clone({
        setHeaders: {
          Authorization: `Bearer ${token}`
        }
      });
    }

    return next.handle(request).pipe(
      catchError((error: HttpErrorResponse) =&gt; {
        if (error.status === 401) {
          // Token expiré ou invalide
          this.authService.logout();
          this.router.navigate([&#39;/auth/login&#39;]);
        }
        return throwError(() =&gt; error);
      })
    );
  }
}
</code></pre><h3 id=configuration-de-l><strong>Configuration de l&rsquo;intercepteur</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// src/app/app.config.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>ApplicationConfig</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/core&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>provideRouter</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/router&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>provideHttpClient</span><span class=p>,</span> <span class=nx>withInterceptors</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@angular/common/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>routes</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./app.routes&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>authInterceptor</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;./core/interceptors/auth.interceptor&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>appConfig</span>: <span class=kt>ApplicationConfig</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>providers</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=nx>provideRouter</span><span class=p>(</span><span class=nx>routes</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>provideHttpClient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>withInterceptors</span><span class=p>([</span><span class=nx>authInterceptor</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=explication-technique--intercepteurs-vs-middleware><strong>Explication technique : Intercepteurs vs Middleware</strong></h3><h4 id=-intercepteurs-angular><strong>🔧 Intercepteurs Angular</strong></h4><ul><li><strong>Côté client</strong> : Exécutés dans le navigateur</li><li><strong>Modification des requêtes</strong> : Ajout d&rsquo;headers, transformation du body</li><li><strong>Gestion des réponses</strong> : Transformation des données, gestion d&rsquo;erreurs</li><li><strong>Chaînage</strong> : Plusieurs intercepteurs peuvent s&rsquo;enchaîner</li></ul><h4 id=-ordre-d><strong>🔄 Ordre d&rsquo;exécution</strong></h4><ol><li><strong>Intercepteurs sortants</strong> : Modifient les requêtes avant envoi</li><li><strong>Requête HTTP</strong> : Envoi au serveur</li><li><strong>Intercepteurs entrants</strong> : Traitent la réponse</li><li><strong>Composant</strong> : Reçoit les données finales</li></ol><hr><h2 id=-test-fonctionnel---étape-25--intercepteurs-http>🧪 Test fonctionnel - Étape 2.5 : Intercepteurs HTTP</h2><h3 id=vérifications-à-effectuer--2><strong>Vérifications à effectuer :</strong></h3><h4 id=1-test-de-l><strong>1. Test de l&rsquo;intercepteur d&rsquo;authentification</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Ouvrir les DevTools (F12)</span>
</span></span><span class=line><span class=cl><span class=c1># Aller dans l&#39;onglet Network</span>
</span></span><span class=line><span class=cl><span class=c1># Se connecter à l&#39;application</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Les requêtes HTTP incluent le header <code>Authorization: Bearer &lt;token></code></li><li><input disabled type=checkbox> Le token est automatiquement ajouté aux requêtes</li><li><input disabled type=checkbox> Pas d&rsquo;erreur 401 lors des requêtes authentifiées</li></ul><h4 id=2-test-de-la-gestion-des-erreurs-401><strong>2. Test de la gestion des erreurs 401</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Simuler une erreur 401 (token expiré)</span>
</span></span><span class=line><span class=cl><span class=c1># Modifier le token dans le localStorage pour le rendre invalide</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Tests à réaliser :</strong></p><ul><li><input disabled type=checkbox> Redirection automatique vers <code>/auth/login</code> en cas d&rsquo;erreur 401</li><li><input disabled type=checkbox> Le token invalide est supprimé</li><li><input disabled type=checkbox> L&rsquo;utilisateur est déconnecté automatiquement</li></ul><h4 id=3-test-des-requêtes-non-authentifiées><strong>3. Test des requêtes non authentifiées</strong></h4><ul><li><input disabled type=checkbox> Les requêtes vers <code>/auth/*</code> ne doivent pas avoir de token</li><li><input disabled type=checkbox> Pas d&rsquo;erreur pour les routes publiques</li><li><input disabled type=checkbox> Les requêtes vers les API protégées incluent le token</li></ul><p><strong>🔧 Debug en cas de problème :</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Vérifier les headers des requêtes</span>
</span></span><span class=line><span class=cl>F12 → Network → Cliquer sur une requête → Headers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier le token dans le localStorage</span>
</span></span><span class=line><span class=cl>F12 → Application → Local Storage → Vérifier le token
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vérifier les logs de l&#39;intercepteur</span>
</span></span><span class=line><span class=cl>F12 → Console → Vérifier les logs d<span class=err>&#39;</span>interception
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-test-fonctionnel---validation-complète-de-la-partie-2>🧪 Test fonctionnel - Validation complète de la Partie 2</h2><h3 id=test-d><strong>Test d&rsquo;intégration global</strong></h3><h4 id=1-parcours-utilisateur-complet><strong>1. Parcours utilisateur complet</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Test complet de l&#39;application</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Scénario à tester :</strong></p><ol><li><input disabled type=checkbox> Aller sur <code>/auth/register</code> et créer un nouveau compte</li><li><input disabled type=checkbox> Se connecter avec le nouveau compte</li><li><input disabled type=checkbox> Naviguer vers <code>/todos</code> et créer quelques tickets</li><li><input disabled type=checkbox> Changer le statut des tickets</li><li><input disabled type=checkbox> Se déconnecter et se reconnecter</li><li><input disabled type=checkbox> Vérifier que les données persistent</li></ol><h4 id=2-parcours-admin-complet><strong>2. Parcours admin complet</strong></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Test de l&#39;interface admin</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>✅ Scénario à tester :</strong></p><ol><li><input disabled type=checkbox> Se connecter en tant qu&rsquo;admin</li><li><input disabled type=checkbox> Aller sur <code>/admin</code></li><li><input disabled type=checkbox> Voir la liste des utilisateurs et tickets</li><li><input disabled type=checkbox> Supprimer un ticket</li><li><input disabled type=checkbox> Supprimer un utilisateur (non admin)</li><li><input disabled type=checkbox> Vérifier que les suppressions fonctionnent</li></ol><h4 id=3-test-de-sécurité><strong>3. Test de sécurité</strong></h4><ul><li><input disabled type=checkbox> Essayer d&rsquo;accéder à <code>/admin</code> sans être admin → redirection</li><li><input disabled type=checkbox> Essayer d&rsquo;accéder à <code>/todos</code> sans être connecté → redirection</li><li><input disabled type=checkbox> Vérifier que les guards fonctionnent correctement</li></ul><h4 id=4-test-des-intercepteurs-http><strong>4. Test des intercepteurs HTTP</strong></h4><ul><li><input disabled type=checkbox> Vérifier les logs dans la console lors des requêtes</li><li><input disabled type=checkbox> Tester les notifications toast (login, logout, erreurs)</li><li><input disabled type=checkbox> Vérifier que les tokens sont ajoutés aux headers</li><li><input disabled type=checkbox> Tester la gestion des erreurs 401/403/500</li></ul><h4 id=5-test-de-performance><strong>5. Test de performance</strong></h4><ul><li><input disabled type=checkbox> Chargement initial rapide</li><li><input disabled type=checkbox> Navigation fluide entre les pages</li><li><input disabled type=checkbox> Lazy loading fonctionne</li><li><input disabled type=checkbox> Pas de fuites mémoire</li></ul><p><strong>🎯 Critères de réussite :</strong></p><ul><li>✅ Tous les formulaires fonctionnent avec validation</li><li>✅ L&rsquo;authentification est sécurisée avec tokens JWT</li><li>✅ Les guards protègent les routes efficacement</li><li>✅ L&rsquo;interface admin est complète avec statistiques</li><li>✅ Les intercepteurs gèrent les tokens et erreurs</li><li>✅ Système de notifications fonctionnel</li><li>✅ Pas d&rsquo;erreurs dans la console</li><li>✅ Performance satisfaisante</li></ul><hr><h2 id=-état-actuel-de-lapplication>🎯 État actuel de l&rsquo;application</h2><h3 id=fonctionnalités-implémentées-><strong>Fonctionnalités implémentées :</strong></h3><ul><li>✅ <strong>Authentification complète</strong> : Login/Register avec validation</li><li>✅ <strong>Formulaires réactifs</strong> : Validation en temps réel, gestion d&rsquo;erreurs</li><li>✅ <strong>Guards de protection</strong> : AuthGuard et AdminGuard</li><li>✅ <strong>Lazy loading</strong> : Chargement à la demande des modules</li><li>✅ <strong>Interface admin avancée</strong> : Gestion des utilisateurs et tickets avec statistiques</li><li>✅ <strong>Intercepteurs HTTP</strong> : Gestion centralisée des requêtes et authentification</li><li>✅ <strong>Validation avancée</strong> : Validateurs personnalisés et gestion d&rsquo;erreurs</li><li>✅ <strong>Système de notifications</strong> : Toast notifications avec ErrorService</li><li>✅ <strong>Gestion des tokens JWT</strong> : Authentification automatique avec intercepteurs</li></ul><h3 id=concepts-maîtrisés-><strong>Concepts maîtrisés :</strong></h3><ul><li><strong>ReactiveFormsModule</strong> : FormBuilder, FormGroup, FormControl</li><li><strong>Validators</strong> : Built-in et personnalisés (passwordMatchValidator)</li><li><strong>Route Guards</strong> : CanActivateFn, protection des routes</li><li><strong>Lazy Loading</strong> : Performance et organisation du code</li><li><strong>Interceptors HTTP</strong> : Gestion centralisée des requêtes et authentification</li><li><strong>Signals</strong> : État réactif moderne d&rsquo;Angular 20+</li><li><strong>ErrorService</strong> : Gestion centralisée des erreurs et notifications</li><li><strong>Toast Notifications</strong> : Interface utilisateur pour les feedbacks</li></ul><h3 id=prêt-pour-la-partie-3-><strong>Prêt pour la Partie 3 :</strong></h3><ul><li>✅ Formulaires complexes et validation avancée</li><li>✅ Gestion d&rsquo;état avec Signals</li><li>✅ Services avec cache et optimisation</li><li>✅ Tests unitaires et d&rsquo;intégration</li></ul><hr><p><em>💡 <strong>Conseil du mentor :</strong> Les formulaires réactifs sont plus puissants que les formulaires template-driven. Prenez le temps de comprendre la différence et quand utiliser chacun. Les Guards et Intercepteurs sont essentiels pour la sécurité de vos applications.</em></p><p><em>🔧 <strong>Conseil qualité :</strong> La validation des formulaires est cruciale pour l&rsquo;expérience utilisateur. Utilisez des validateurs personnalisés pour des règles métier complexes. Les Guards protègent votre application des accès non autorisés.</em></p><p><em>⚡ <strong>Conseil ESLint :</strong> Respectez toujours les règles de linting. Utilisez <code>inject()</code> au lieu de l&rsquo;injection par constructeur, évitez les variables inutilisées, et préférez <code>console.warn</code>/<code>console.error</code> à <code>console.log</code>. Un code propre est plus maintenable.</em></p><hr><h2 id=-préparation-pour-la-partie-3>🚀 Préparation pour la Partie 3</h2><h3 id=objectifs-de-la-partie-3-><strong>Objectifs de la Partie 3 :</strong></h3><ul><li>🎨 <strong>Composants réutilisables</strong> : Création de composants génériques</li><li>🔄 <strong>Gestion d&rsquo;état avancée</strong> : Services avec cache, optimisation</li><li>🧪 <strong>Tests unitaires</strong> : Tests des composants et services</li><li>📱 <strong>Responsive design</strong> : Interface adaptative</li><li>🎯 <strong>Performance</strong> : Optimisation et lazy loading avancé</li></ul><h3 id=concepts-à-maîtriser-><strong>Concepts à maîtriser :</strong></h3><ul><li><strong>Composants standalone</strong> : Architecture moderne d&rsquo;Angular</li><li><strong>Services avec cache</strong> : Optimisation des performances</li><li><strong>Tests unitaires</strong> : Jasmine et TestBed</li><li><strong>Responsive design</strong> : Tailwind CSS avancé</li><li><strong>Performance</strong> : OnPush strategy, trackBy functions</li></ul><h3 id=prérequis-validés-><strong>Prérequis validés :</strong></h3><ul><li>✅ Authentification et autorisation</li><li>✅ Formulaires réactifs avec validation</li><li>✅ Guards et intercepteurs</li><li>✅ Interface admin fonctionnelle</li><li>✅ Architecture DDD solide</li></ul><hr><p><em>🎯 <strong>Prêt pour la Partie 3 !</strong> Votre application a maintenant une authentification complète et des formulaires robustes. Dans la Partie 3, nous nous concentrerons sur la création de composants réutilisables et l&rsquo;optimisation des performances.</em></p></article></main><footer class="bg-gray-800 text-white py-8 mt-16"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class=text-center><p>&copy; 2025 Cours Angular 5ème année. Tous droits réservés.</p><p class="text-gray-400 mt-2">Cours Angular 20+ pour les étudiants de 5ème année</p></div></div></footer><script>document.addEventListener("DOMContentLoaded",function(){Prism.highlightAll()}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})})</script></body></html>